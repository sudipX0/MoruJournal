{% extends "layouts.html" %}
{% block content %}
<div class="max-w-4xl mx-auto p-6 space-y-6 bg-gray-100 min-h-screen">

  <!-- Recent Blogs Heading -->
  <h1 class="text-3xl font-bold text-gray-800 mb-6 text-center">Recent Blogs</h1>

  <!-- Blog Posts -->
  {% for post in posts.items %}
  <article class="bg-white shadow-md rounded-lg p-4 flex items-center space-x-4">
    <!-- Author Image -->
    <div class="flex-shrink-0">
      <img src="{{ url_for('static', filename='images/' + post.author.image_file) }}" 
           alt="Author Image" 
           class="w-12 h-12 rounded-full border border-gray-300">
    </div>

    <!-- Post Details -->
    <div class="flex-1">
      <!-- Author and Date -->
      <div class="flex items-center justify-between">
        <div class="flex items-center space-x-2">
          <!-- Link to user-specific blog page -->
          {% if post.author == current_user %}
          <a href="{{ url_for('my_blogs') }}" 
             class="text-gray-800 font-medium hover:underline">
             {{ post.author.username }}
          </a>
          {% else %}
          <a href="{{ url_for('user_blogs', username=post.author.username) }}" 
             class="text-gray-800 font-medium hover:underline">
             {{ post.author.username }}
          </a>
          {% endif %}
          <span class="text-sm text-gray-500">Â· {{ post.date_posted.strftime('%Y-%m-%d') }}</span>
        </div>
      </div>

      <!-- Post Title -->
      <h2 class="mt-2 text-lg font-semibold text-blue-600 hover:text-gray-800">
        <a href="{{ url_for('post', post_id=post.post_id)}}" class="hover:underline">
          {{ post.title }}
        </a>
      </h2>

      <!-- Post Content -->
      <p class="mt-2 text-gray-600 text-sm leading-relaxed line-clamp-3">
        {{ post.content }}
      </p>
    </div>
  </article>
  {% endfor %}

  <!-- Pagination -->
  <div class="mt-6 flex justify-center">
    {% for page_num in posts.iter_pages(left_edge=1, right_edge=1, left_current=1, right_current=1) %}
        {% if page_num %}
            {% if posts.page == page_num %}
                <a href="{{ url_for('main', page=page_num)}}" 
                   class="bg-blue-700 text-white px-4 py-2 mx-1 rounded-md hover:bg-blue-800 transition">
                    {{ page_num }}
                </a>
            {% else %}
                <a href="{{ url_for('main', page=page_num)}}" 
                   class="bg-gray-200 text-gray-700 px-4 py-2 mx-1 rounded-md hover:bg-gray-300 transition">
                    {{ page_num }}
                </a>
            {% endif %}
        {% endif %}
    {% endfor %}
  </div>

</div>
{% endblock content %}
